package LintCode.白银2;

import java.util.Arrays;

/**
 * N个人在玩游戏，每局游戏有一个裁判和N-1个平民玩家。给出一个数组A, A[i]代表玩家i至少需要成为平民A[i]次，返回最少进行游戏的次数。
 *
 * 样例
 * 样例 1
 *
 * 输入：A = [2, 2, 2, 2]
 * 输出：3
 * 解析：A[0] = 2表示玩家0至少需要成为2次平民
 * 第一局：玩家0担任裁判，此时 A[0] = 0, A[1] = 1, A[2] = 1, A[3] =1
 * 第二局：玩家1担任裁判，此时 A[0] = 1, A[1] = 1, A[2] = 2, A[3] = 2
 * 第三局：玩家2担任裁判，此时 A[0] = 2, A[1] = 2, A[2] = 2, A[3] = 3
 * 此时每个玩家都达到了要求，所以进行三局游戏即可
 * 注意事项
 * ∑Ai<=1e18
 * n>1
 */
public class 玩游戏 {
    public static void main(String[] args) {
        int[] a = new int[]{500023556,500011764,500002781,500014185,500030108,500001641,500027907,500015524,500006183,500026711,500018892,500000204,500005471,500002015,500018661,500000178,500023396,500011505,500007055,500019803,500002225,500018283,500020537,500024908,500031823,500003717,500001108,500023300,500013896,500012140,500026723,500016587,500007263,500020269,500019025,500012714,500030462,500025557,500006664,500010171,500014960,500010454,500007231,500012195,500028752,500012973,500016275,500014684,500021826,500026050,500018394,500026168,500032481,500021648,500017332,500030754,500007672,500018693,500000098,500017959,500012532,500032044,500028636,500023094,500015001,500018185,500013597,500007204,500020725,500015301,500019138,500011763,500006290,500003595,500030675,500023892,500032752,500011185,500001761,500020074,500020274,500024219,500029521,500017361,500024600,500029916,500000247,500010207,500004653,500013343,500029159,500015146,500020290,500007238,500020103,500003146,500013338,500015696,500029673,500007392,500012647,500009344,500023640,500022487,500014581,500009403,500022065,500015593,500019238,500032307,500007413,500025957,500030878,500010562,500002203,500017968,500011327,500018584,500018219,500021258,500020824,500001689,500021640,500026387,500010777,500025089,500009357,500005774,500027211,500011722,500013148,500019940,500027198,500018511,500028659,500025068,500001538,500019889,500013569,500030057,500031961,500018810,500017399,500022485,500025837,500011136,500030305,500016733,500001855,500001037,500006519,500004140,500014304,500019260,500010223,500027372,500032355,500014246,500022038,500027786,500008850,500026686,500009247,500015674,500029024,500025978,500027323,500015548,500019999,500015796,500005610,500008669,500025587,500016591,500000528,500013120,500002951,500007965,500012107,500032094,500014590,500028544,500016132,500010700,500001581,500024784,500028612,500023485,500011527,500006781,500002889,500013767,500001624,500004214,500031450,500027882,500024759,500020041,500030167,500003278,500017333,500032139,500032404,500020812,500029531,500011130,500008551,500014640,500018388,500004577,500010752,500013885,500011622,500026428,500017145,500007794,500024743,500031261,500013230,500017036,500015085,500007118,500012367,500019916,500008966,500007736,500028724,500021242,500030249,500026883,500032368,500010922,500032045,500027135,500030888,500001726,500016889,500025795,500012326,500024364,500022844,500026004,500024873,500007170,500029790,500023432,500029823,500008359,500020406,500007658,500032598,500007267,500020733,500024801,500030032,500017441,500027138,500023885,500016597,500022900,500005024,500012274,500013741,500008921,500029933,500013272,500004558,500014652,500002741,500023537,500000114,500020157,500025383,500020477,500021357,500021171,500016845,500020651,500026302,500005873,500016322,500009985,500025188,500023113,500015391,500008957,500020083,500023631,500012470,500028029,500011622,500024159,500016131,500012636,500004279,500013794,500002399,500024542,500023469,500021452,500011383,500005198,500010358,500025961,500027901,500023269,500000885,500029274,500028061,500024302,500028893,500007131,500000307,500017448,500028799,500024903,500027963,500012140,500029664,500003549,500012424,500017039,500031375,500013252,500008762,500003978,500018613,500022605,500031978,500018136,500027630,500013689,500010791,500009504,500000599,500013499,500025126,500025620,500030697,500001790,500029621,500012953,500011781,500032234,500018545,500030760,500016719,500002659,500031033,500026484,500025024,500001107,500001762,500009293,500028919,500008106,500002860,500000196,500023248,500012963,500030197,500005520,500023608,500012616,500010925,500014768,500011328,500000568,500004618,500007506,500015216,500004264,500029693,500003060,500032093,500016296,500011748,500006601,500028797,500008871,500006401,500016478,500022587,500007994,500013611,500011901,500023879,500023577,500027587,500020306,500002096,500008554,500032490,500019660,500018996,500003651,500030961,500004422,500002135,500018282,500012305,500003175,500023730,500000863,500012893,500016198,500000526,500006044,500011764,500021458,500007601,500027419,500010619,500017266,500023416,500029209,500008395,500020712,500004134,500005914,500023014,500022907,500022012,500013613,500001584,500016725,500022410,500001905,500000988,500032554,500015556,500012760,500021412,500002842,500028248,500018219,500005821,500013529,500009023,500028750,500010506,500009485,500027794,500006342,500011152,500003575,500013216,500017528,500004906,500020310,500024125,500029363,500003965,500004488,500003421,500012913,500024111,500007155,500010721,500019418,500024148,500027299,500013232,500008970,500030761,500018228,500001802,500014356,500011525,500026867,500003097,500026695,500025484,500024640,500001225,500021680,500017446,500020791,500027866,500004575,500014768,500016783,500008244,500001262,500027249,500032193,500015226,500004544,500015695,500022893,500027361,500032391,500016194,500020218,500006979,500012425,500032010,500017022,500016751,500009763,500009501,500027613,500011204,500021006,500001508,500011316,500004606,500015329,500015398,500021112,500022351,500002519,500009669,500004954,500012978,500022483,500027816,500014446,500012668,500032673,500015864,500019085,500018483,500013951,500000399,500015224,500026020,500009180,500009645,500021181,500015408,500021855,500021229,500025055,500013671,500013355,500007288,500000945,500017368,500024418,500000121,500027395,500001830,500004071,500019665,500001152,500030303,500026985,500015371,500028631,500001162,500023709,500024210,500005145,500029567,500032458,500009249,500021346,500018684,500031371,500006524,500008636,500006644,500032209,500011870,500000832,500008234,500018727,500006066,500013695,500019967,500017466,500008709,500002080,500021640,500015256,500002108,500010442,500020452,500011192,500008834,500026180,500003533,500015675,500000389,500011994,500008812,500022129,500018914,500019971,500016242,500026143,500025565,500011586,500000356,500019327,500021334,500007242,500010038,500032649,500019449,500025701,500026652,500025457,500021940,500011030,500023453,500022641,500005486,500026621,500010217,500001224,500003574,500029180,500027244,500027139,500027961,500026520,500003747,500012411,500014777,500030370,500001839,500019487,500029754,500018198,500007464,500024179,500000446,500003395,500018867,500031193,500029108,500001836,500019927,500010768,500029805,500026927,500031884,500026106,500005583,500032228,500027413,500020130,500004173,500032072,500031632,500024445,500019479,500024347,500030156,500029680,500024205,500011398,500008794,500017939,500007674,500005377,500007143,500019125,500007551,500019060,500019145,500003744,500009549,500026780,500016087,500031005,500031511,500027569,500023422,500006075,500003784,500031302,500002577,500022349,500024433,500001648,500026209,500020018,500011397,500002602,500006542,500031705,500018248,500025336,500022300,500008579,500006277,500004299,500012361,500006219,500011903,500023589,500012702,500018532,500026411,500010109,500032453,500009635,500002716,500028645,500024730,500021821,500027071,500016618,500031108,500024785,500021832,500008124,500005126,500006825,500000236,500012687,500016273,500005949,500009937,500008512,500012189,500024568,500032579,500002108,500004344,500017215,500024744,500024222,500018781,500026032,500007094,500013975,500021832,500030887,500026595,500018195,500014345,500014855,500029725,500002457,500012823,500008503,500028604,500028531,500012712,500023914,500008117,500029200,500012670,500002340,500021520,500000678,500031236,500014074,500020892,500007451,500030873,500015257,500000993,500000550,500008492,500022793,500002902,500023730,500003593,500012083,500031700,500022147,500020978,500005537,500024395,500024603,500012402,500017030,500020660,500012255,500012398,500025342,500017222,500015478,500015613,500002198,500018925,500013938,500018554,500004111,500029432,500017714,500009687,500025951,500003089,500002822,500003123,500018681,500025203,500013461,500030895,500031310,500021335,500006012,500025214,500027540,500016559,500009272,500030012,500025286,500015895,500012102,500017793,500011244,500002569,500021896,500013237,500016540,500010064,500032747,500028966,500002241,500010943,500019015,500023383,500006299,500004386,500020871,500008604,500004103,500012661,500011529,500026851,500032513,500008020,500005960,500025045,500029543,500004531,500002488,500001310,500005119,500008655,500020465,500027144,500027836,500030308,500022032,500027471,500020541,500012065,500013914,500003633,500029335,500009305,500018979,500024516,500008532,500020219,500016879,500015500,500015548,500027844,500002262,500013901,500022099,500013491,500030509,500003102,500006306,500012222,500006242,500026815,500023610,500002499,500002088,500023340,500003575,500028353,500010964,500015730,500019074,500018504,500017671,500032194,500021273,500028462,500013966,500032196,500016275,500009604,500023686,500031789,500004510,500027848,500024260,500015508,500003404,500003164,500027764,500024962,500031438,500023607,500011263,500011464,500013695,500010203,500025139,500006677,500011300,500015751,500005278,500001991,500013937,500032173,500011066,500025090,500025552,500032422,500021840,500001023,500010079,500006309,500013718,500017319,500001335,500028138,500006554,500023393,500009460,500017208,500016484,500009768,500028018,500015496,500029783,500025056,500003540,500020991,500031833,500027626,500006091,500004382,500010292,500011254}; //输出137
        long start = System.currentTimeMillis();
        System.out.println(playGames(a));
        System.out.println(System.currentTimeMillis() - start);
    }

    /**
     * @param A:
     * @return: nothing
     */
    public static long playGames(int[] A) {
        int max=0;
        for(int a:A){
            max=Math.max(a,max);
        }
        long l=0,r=max*2;
        while(l<r){//cnt表式某一人完成时的游戏次数
            long m=(l+r)/2;
            long cnt=0;
            for(int a:A){
                cnt+=Math.max(m-a,0);
            }
            if(m>cnt){
                l=m+1;
            }else{
                r=m;
            }
        }
        return Math.max(l,max);
    }

    public static long playGames2(int[] A) {
        Arrays.sort(A);
        int len = A.length;
        long result = 0;
        while (A[0] != 0) {
            for (int i = 1; i < len; i++) {
                A[i] --;
                if (A[i] < A[0]) {
                    A[i] ^= A[0];
                    A[0] ^= A[i];
                    A[i] ^= A[0];
                }
            }
            result ++;
        }
        Arrays.sort(A);
        result += A[len-1];
        return result;
    }
}
